/**
 * èŠ‚ç‚¹é¢æ¿ - æ˜¾ç¤ºå¯ç”¨çš„èŠ‚ç‚¹ç±»å‹
 * ç”¨æˆ·å¯ä»¥ç‚¹å‡»æ·»åŠ åˆ°ç”»å¸ƒ
 */

import React from 'react'
import { Card, Space, Button, Divider } from 'antd'
import {
  PlayCircleOutlined,
  RobotOutlined,
  CheckCircleOutlined,
  DatabaseOutlined
} from '@ant-design/icons'

const NodePanel = ({ nodeTypes, onAddNode }) => {
  // å†…ç½®èŠ‚ç‚¹ç±»å‹ï¼ˆåŸºç¡€ï¼‰
  const builtInNodes = [
    {
      type: 'start',
      label: 'å¼€å§‹',
      icon: <PlayCircleOutlined />,
      color: '#52c41a',
      description: 'å·¥ä½œæµå…¥å£'
    },
    {
      type: 'llm',
      label: 'LLMå¯¹è¯',
      icon: <RobotOutlined />,
      color: '#1890ff',
      description: 'AIå¤§æ¨¡å‹å¯¹è¯'
    },
    {
      type: 'end',
      label: 'ç»“æŸ',
      icon: <CheckCircleOutlined />,
      color: '#ff4d4f',
      description: 'å·¥ä½œæµå‡ºå£'
    }
  ]
  
  const handleAddNode = (nodeType) => {
    // åœ¨ç”»å¸ƒä¸­å¿ƒä½ç½®æ·»åŠ èŠ‚ç‚¹
    const position = {
      x: Math.random() * 300 + 100,
      y: Math.random() * 300 + 100
    }
    onAddNode(nodeType, position)
  }
  
  return (
    <div className="workflow-editor-node-panel">
      <Card
        title="èŠ‚ç‚¹åº“"
        size="small"
        bodyStyle={{ padding: '12px' }}
      >
        <div className="node-panel-section">
          <h4>åŸºç¡€èŠ‚ç‚¹</h4>
          <Space direction="vertical" style={{ width: '100%' }}>
            {builtInNodes.map((node) => (
              <Button
                key={node.type}
                block
                icon={node.icon}
                style={{
                  borderColor: node.color,
                  color: node.color,
                  textAlign: 'left',
                  height: 'auto',
                  padding: '8px 12px'
                }}
                onClick={() => handleAddNode(node.type)}
              >
                <div>
                  <div style={{ fontWeight: 'bold' }}>{node.label}</div>
                  <div style={{ fontSize: '12px', opacity: 0.7 }}>
                    {node.description}
                  </div>
                </div>
              </Button>
            ))}
          </Space>
        </div>
        
        {nodeTypes && nodeTypes.length > 0 && (
          <>
            <Divider />
            <div className="node-panel-section">
              <h4>æ‰©å±•èŠ‚ç‚¹</h4>
              <Space direction="vertical" style={{ width: '100%' }}>
                {nodeTypes.map((node) => (
                  <Button
                    key={node.type_key}
                    block
                    icon={<DatabaseOutlined />}
                    onClick={() => handleAddNode(node.type_key)}
                  >
                    {node.display_name}
                  </Button>
                ))}
              </Space>
            </div>
          </>
        )}
        
        <Divider />
        <div className="node-panel-tips">
          <p style={{ fontSize: '12px', color: '#999', margin: 0 }}>
            ğŸ’¡ ç‚¹å‡»èŠ‚ç‚¹æ·»åŠ åˆ°ç”»å¸ƒ
          </p>
        </div>
      </Card>
    </div>
  )
}

export default NodePanel
