# Casbin教学系统权限模型配置
# 使用RBAC with hierarchy模型，支持多级继承

[request_definition]
# 请求定义：主体、对象、操作
r = sub, obj, act

[policy_definition]
# 策略定义：主体、对象、操作、效果（allow/deny）
p = sub, obj, act, eft

[role_definition]
# g: 用户-角色/组继承关系
# g2: 对象-对象继承关系（如lesson继承module权限）
g = _, _
g2 = _, _

[policy_effect]
# 策略效果：拒绝优先（deny-override）
# 如果有任何deny策略匹配，则拒绝；否则如果有allow策略匹配，则允许
e = some(where (p.eft == deny)) && deny || some(where (p.eft == allow)) && allow || deny

[matchers]
# 匹配器：检查主体和对象的继承关系
# g(r.sub, p.sub): 检查请求主体是否属于策略主体（支持继承）
# g2(r.obj, p.obj): 检查请求对象是否属于策略对象（支持继承）
# r.act == p.act: 操作必须完全匹配
m = g(r.sub, p.sub) && g2(r.obj, p.obj) && r.act == p.act
