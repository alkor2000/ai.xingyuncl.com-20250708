# Casbin教学系统权限模型配置
# 使用RBAC with domains模型，支持多级继承

[request_definition]
# 请求定义：主体、对象、操作
r = sub, obj, act

[policy_definition]
# 策略定义：主体、对象、操作
# 注意：标准Casbin不直接支持effect字段，需要用其他方式处理deny
p = sub, obj, act

[role_definition]
# g: 用户角色继承关系（用户->标签->组）
# g2: 对象继承关系（课程->模块）  
g = _, _
g2 = _, _

[policy_effect]
# 策略效果：允许（如果有任何允许策略匹配）
e = some(where (p.eft == allow))

[matchers]
# 匹配器：检查主体和对象的继承关系
# g(r.sub, p.sub): 检查请求主体是否属于策略主体（支持继承）
# g2(r.obj, p.obj): 检查请求对象是否属于策略对象（支持继承）
# r.act == p.act: 操作必须完全匹配
m = g(r.sub, p.sub) && g2(r.obj, p.obj) && r.act == p.act
